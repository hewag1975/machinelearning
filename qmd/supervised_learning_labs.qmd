---
title: "Labs supervised learning"
format: html
editor: source
editor_options: 
  chunk_output_type: console
engine: knitr
---

```{r}
knitr::opts_knit$set(
  root.dir = '~/Documents/repos/github/machinelearning'
)
```




## Snippets

```{python}
import numpy as np

x = np.random.normal(size=100, loc=1, scale=2)
sum(x)

np.dot()

np.array([1, 2])

w1 = np.array([0.2, -0.5])
w2 = np.array([0.2, -0.5])
w1+w2
dj_dw = np.zeros(w.shape)
dj_dw.shape



```

```{r}
mse = function(x, y, w, b){
p = x * w + b
se = sum((p - y)^2)
mse = se / 2 / length(p)
return(mse)
}

x = 1:100
y = 0.35 * x + rnorm(100, mean = 0, sd = 8) 
y = y + 24.85

plot(x, y, pch = 19, ylim = c(0, 100))

w = runif(100, -5, 5)
b = 5
# b = runif(100, -50, 50)

cost = Map(
mse
, x = list(x)
, y = list(y)
, w = w
, b = b
) |> 
unlist()

cost = cost[order(w)]
w = w[order(w)]

plot(w, cost, type = "l")
```

